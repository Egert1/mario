<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
    #mario{
        width:40px;
        position:fixed;
        transform: translate(-20px, -53px);
        transform-origin: 20px 53px;
    }
    #mariojump{
        width:56px;
        position:fixed;
        display: none
    }
    #goomba{
        width:25px;
        position:fixed;
        transform: translate(-12px, -25px);
        transform-origin: 12px 25px;
    }
     </style>
</head>
<body>
    <img src="mario.png" id="mario"  alt="">
    <img src="mariojump.png" id="mariojump" alt="">
    <img src="goomba.png" id="goomba" alt="">

    
    <script>
        let mario = {
            x: 450,
            y: 150,
            w: 36,
            h: 53,
            speed: 4,
            direction: 0, //-1 left, 0 still, 1 right
            isDead: false
        }
        let goomba = {
            x: 250,
            y: 150,
            w: 22,
            h: 25,
        }
        let marioSprite = document.getElementById("mario")
        marioSprite.myOffset = [20,53]
        let mariojumpSprite = document.getElementById("mariojump")
        let goombaSprite = document.getElementById("goomba")
        goombaSprite.myOffset = [12,25]

        setSpritePos(marioSprite, mario.x, mario.y)
        setSpritePos(goombaSprite, goomba.x, goomba.y)


        window.onkeydown = function (e) {
            if(e.keyCode == 37) {
                mario.direction = -1
            } else if(e.keyCode == 39) {
                mario.direction = 1
            }
        };

        setInterval(function() {
            if (mario.isDead) return;

            mario.x+=mario.speed*mario.direction
            setSpritePos(marioSprite, mario.x, mario.y, 0 , mario.direction || 1)

            if (detectCollision(mario, goomba)) {
                mario.isDead = true
            }

            if (mario.isDead) {
                console.log("test")
                setSpritePos(marioSprite, mario.x, mario.y, 90*mario.direction, mario.direction || 1)
                //mario.direction = 0
            }
        }, 33)

        function setSpritePos(spr, x, y, rot=0, scaleX=1) {
            spr.style.top=y+"px"
            spr.style.left=x+"px"
            spr.style.transform=`translate(-${spr.myOffset[0]}px, -${spr.myOffset[1]}px) rotate(${rot}deg) scaleX(${scaleX})`
        }

        function detectCollision(rect1, rect2) {
            return (rect1.x < rect2.x + rect2.w &&
                rect1.x + rect1.w > rect2.x &&
                rect1.y < rect2.y + rect2.h &&
                rect1.h + rect1.y > rect2.y)
        }
    </script>
</body>
</html>